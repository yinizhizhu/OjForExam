#include <iostream>

using namespace std;

const int N = 100000;
struct word {
	char c;
	int next;
	word() {
		c = '\0';
		next = -1;
	}
	void reset() { next = -2; }
};
word container[N];

int getLen(int head) {
	if (container[head].next == -2) return 0;
	int ans = 1;
	while (container[head].next + 1) {
		//cout << container[head].c;
		ans++;
		head = container[head].next;
	}
	//cout << container[head].c << endl;
	return ans;
}

int main() {
	char c;
	int heada, headb;
	int n, cur, next;
	int ans, lena, lenb;
	while (cin >> heada >> headb >> n) {
		for (int i = 0; i < N; i++) container[i].reset();
		ans = -1;
		for (; n; n--) {
			cin >> cur >> c >> next;
			container[cur].c = c;
			container[cur].next = next;
		}
		lena = getLen(heada);
		lenb = getLen(headb);
		if (lena && lenb) {
			if (lena > lenb) {
				lena -= lenb;
				for (; lena; lena--)
					heada = container[heada].next;
			}
			else {
				lenb -= lena;
				for (; lenb; lenb--)
					headb = container[headb].next;
			}
			//cout << heada << " " << headb << endl;
			//cout << container[heada].c << " " << container[headb].c << endl;
			while (container[heada].next + 1){
				if (heada == headb) {
					ans = heada;
					break;
				}
				heada = container[heada].next;
				headb = container[headb].next;
			}
		}
		cout << ans << endl;
	}
	return 0;
}
